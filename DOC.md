# OnTrip API Documentation

# Escribo Test API

## Conteúdo

- [Documentation](#escribo-test-api)
  - [Conteúdo](#conteúdo)
  - [1. Sobre o Projeto](#1-sobre-o-projeto)
  - [2. Iniciando o Projeto Localmente](#2-iniciando-o-projeto-localmente)
    - [2.1. Variáveis de Ambiente](#21-variáveis-de-ambiente)
    - [2.2. Docker Compose](#22-docker-compose)
  - [3. Autenticação](#3-autenticação)
  - [4. Endpoints](#4-endpoints)

---

## 1. Sobre o Projeto

Esta API foi construida para a 2ª fase do teste técnico da empresa Escribo.
Tem como objetivo ser uma API de criação, leitura e login de usuários através dos endpoints:

- **/users**
- **/login**

Falaremos sobre cada um logo mais.

Para este projeto, foram utilizadas as seguintes tecnologias:

- [NodeJS](https://nodejs.org/en/)
- [Express](https://expressjs.com/pt-br/)
- [TypeScript](https://www.typescriptlang.org/)
- [PostgreSQL](https://www.postgresql.org/)
- [TypeORM](https://typeorm.io/)
- [Zod](https://zod.dev/)
- [Docker](https://www.docker.com/)

<br/>

URL de base para a aplicação em que foi feito o deploy:

<br/>

**Base URL: https://escribo-tlh7.onrender.com**


---

## 2. Iniciando o Projeto Localmente

[ Topo ](#conteúdo)

Para executar este projeto localmente, você precisará ter o [Docker](https://www.docker.com/) instalado, pois é ele quem vai garantir o banco de dados.

Após clonar o projeto para a sua máquina local, faça uma cópia do arquivo .env.example e preencha os dados da forma correta.

```shell
POSTGRES_URL=postgres://<username>:<password>@database:<port>/<database>
# na url das migrações o host e a porta devem ser as de acesso do container pelo localhost
POSTGRES_URL_MIG=postgres://<username>:<password>@localhost:<port>/<database> 

SECRET_KEY=
```
* POSTGRES_URL e POSTGRES_URL_MIG
  * username: Seu usuário do PostgreSQL
  * password: Sua senha de acesso ao PostgreSQL
  * host: Host do banco de dados (se não estiver utilizando o docker, colocar localhost)
  * port: Porta de acesso ao banco de dados, sendo o das migrations a porta de acesso pelo host local
  * database: Nome do banco de dados
  
* SECRET_KEY
  
  Uma palavra ou hash de segurança de sua escolha

Depois de ter editado o seu arquivo .env você irá editar o arquivo docker-compose.yml e nele você colocará as informações que colocou no seu arquivo .env

Eu deixei comentado os pontos onde deve fazer as mudanças.

Após ter completado essas etapas que são muito importantes, você irá abrir o terminal na pasta do projeto e habilitar o script de 

---

## 4. Authentication

[ Topo ](#conteúdo)

Some routes need authentication. The authentication used is the **Bearer Token** type.

The token is generated automatically at **user login**.

Thus, to access routes with authentication, it is necessary to have a user and be logged in with the user.

In addition, some routes require the user to be an administrator, or owner of the account, or of an accommodation, or the user who made the booking.

Please read each route's documentation to understand which authentications are required.

---

## 5. Endpoints

[ Topo ](#conteúdo)

### Index

- [Users](#1-users)
- [Login](#2-login)
- [Accommodations](#3-accommodations)
- [Bookings](#4-bookings)
- [Addresses](#5-addresses)
- [Categories](#6-categories)
- [Capacities](#7-capacities)
- [Types](#8-types)
- [Photos](#9-photos)

---

## 1. **Users**

[ Back to endpoints index ](#index)

The User object is defined as:

| **Field**   | **Type** | **Description**                                   |
| ----------- | -------- | ------------------------------------------------- |
| id          | string   | User's unique identifier                          |
| username    | string   | User name                                         |
| email       | string   | User email                                        |
| password    | string   | User password                                     |
| dateOfBirth | string   | User's date of birth                              |
| isAdm       | boolean  | Defines whether a user is an administrator or not |
| isActive    | boolean  | Defines whether a user is active or not           |
| file        | file     | User's profile photo file sent in the request     |
| photo       | string   | User's profile photo url generated by cloudinary  |

<br>

### **Endpoints**

| **Method** | **Route**      | **Description**                                 |
| ---------- | -------------- | ----------------------------------------------- |
| POST       | /users         | Creates a user                                  |
| GET        | /users         | List all users                                  |
| GET        | /users/:userId | Lists a user using its ID as a parameter        |
| PATCH      | /users/:userId | Updates a user using its ID as a parameter      |
| DELETE     | /users/:userId | Soft-deletes a user using its ID as a parameter |

<br>

## POST /users

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: multipart/form-data

<br>

**Request body example**

```multipart/form-data
  username: "Bob Spencer",
  email: "bobspencer@email.com",
  password: "874aS4A6F65i",
  dateOfBirth: "14/03/1993",
  isAdm?: true,
  file?: file.jpg
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "User created with success",
  "user": {
    "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
    "username": "Bob Spencer",
    "email": "bobspencer@email.com",
    "dateOfBirth": "14/03/1993",
    "photo": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
    "isAdm": true,
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 409 - Email already exists**

```json
{
  "status": "Error",
  "code": 409,
  "message": "This email already exists"
}
```

#

## GET /users

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin
- Content-type: application/json
- Empty Body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "users": [
    {
      "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
      "username": "Bob Spencer",
      "email": "bobspencer@email.com",
      "dateOfBirth": "14/03/1993",
      "photo": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
      "isAdm": true,
      "isActive": true
    },
    ...
  ]
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## GET /users/:userId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin or the owner of the account
- Content-type: application/json
- Empty Body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "user": {
    "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
    "username": "Bob Spencer",
    "email": "bobspencer@email.com",
    "dateOfBirth": "14/03/1993",
    "photo": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
    "isAdm": true,
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the account**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the account"
}
```

<br>

**Status 404 - User not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "User not found"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## PATCH /users/:userId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin or the owner of the account
- Content-type: multipart/form-data

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

**Request body example**

```multipart/form-data
  username?: "Bob Spencer",
  email?: "bob_spencer@email.com",
  password?: "874aS4A6F65i",
  dateOfBirth?: "14/03/1993",
  *isAdm?: true,
  file?: file.jpg
```

- At least one field is required
- Only Adm users can update the isAdm field

<br>

#### Expected Responses:

<br>

**Status 200 - OK**

```json
{
  "message": "User updated with success",
  "user": {
    "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
    "username": "Bob Spencer",
    "email?": "bob_spencer@email.com",
    "dateOfBirth": "14/03/1993",
    "photo": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg9",
    "isAdm": true,
    "isActive": true
  }
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the account**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the account"
}
```

<br>

**Status 409 - Email already exists**

```json
{
  "status": "Error",
  "code": 409,
  "message": "Email already exists"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 404 - User not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "User not found"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## DELETE /users/:userId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin or the owner of the account
- Content-type: application/json
- Empty Body

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "User deleted with success"
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the account**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the account"
}
```

<br>

**Status 404 - User not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "User not found"
}
```

<br>

**Status 400 - User already deleted**

```json
{
  "status": "Error",
  "code": 400,
  "message": "User already deleted"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

---

## 2. **Login**

[ Back to endpoints index ](#index)

The Login object is defined as:

| **Field** | **Type** | **Description** |
| --------- | -------- | --------------- |
| email     | string   | User email      |
| password  | string   | User password   |

<br>

### **Endpoints**

| **Method** | **Route** | **Description** |
| ---------- | --------- | --------------- |
| POST       | /login    | Login user      |

<br>

#

## POST /login

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json

**Request body example**

```json
{
  "email": "bobspencer@email.com",
  "password": "874aS4A6F65i"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Login successful",
  "token": "yJhbGciOiJIUzI1NiJ9.eyJSb2xlIjoiQWRtaW4iLCJJc3N1ZXIiOiJJc3N1ZXIiLCJVc2VybmFtZSI6IkphdmFJblVzZSIsImV4cCI6MTY2MjY4ODU1OCwiaWF0IjoxNjYyNjg4NTU4fQ.OONsla408_ohD5XE9b3-qfWaniZC95pgyBetmJeKViA"
}
```

<br>

#### Error Responses:

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 401 - Invalid email or password**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid email or password"
}
```

<br>

---

## 3. **Accommodations**

[ Back to endpoints index ](#index)

# Accommodations

The Accommodation object is defined as:

| **Field**     | **Type** | **Description**                                                          |
| ------------- | -------- | ------------------------------------------------------------------------ |
| id            | string   | Accommodation's unique identifier                                        |
| name          | string   | Accommodation name                                                       |
| description   | string   | Accommodation description                                                |
| dailyPrice    | number   | Daily price for accommodation                                            |
| isActive      | boolean  | Defines whether the accommodation is active or not                       |
| verifiedByAdm | boolean  | Defines whether the accommodation is verified by an administrator or not |
| specialOffer  | boolean  | Defines whether the accommodation has a special offer or not             |
| owner         | object   | User who owns the accommodation                                          |
| type          | object   | Accommodation type                                                       |
| capacity      | object   | Accommodation capacity                                                   |
| category      | object   | Accommodation category                                                   |

<br>

### **Endpoints**

| **Method** | **Route**                        | **Description**                                           |
| ---------- | -------------------------------- | --------------------------------------------------------- |
| POST       | /accommodations                  | Creates an accommodation                                  |
| GET        | /accommodations                  | Lists all accommodations                                  |
| GET        | /accommodations/:accommodationId | Lists an accommodation using its ID as a parameter        |
| PATCH      | /accommodations/:accommodationId | Updates an accommodation using its ID as a parameter      |
| DELETE     | /accommodations/:accommodationId | Soft-deletes an accommodation using its ID as a parameter |

<br>

#

## POST /accommodations

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "name": "Complete apartment to work",
  "description": "Ideal apartment to work remotely, quiet, comfortable, and with all the requirements for a perfect home office.",
  "dailyPrice": 450,
  "typeId": "6e79c2b7-c479-46e3-aeac-b9f62739799e",
  "userId": "04506439-de18-4700-9175-1876e0ed8c34",
  "capacityId": "0b327321-603d-45a7-b4cd-525c11c14b04",
  "categoryId": "d3b5f8db-a292-46b4-ae69-7821c2789dcd"
}
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "Accommodation created with success",
  "accommodation": {
    "id": "90ee8282-af60-4570-9847-fb99d5555355",
    "name": "Complete apartment to work",
    "description": "Ideal apartment to work remotely, quiet, comfortable, and with all the requirements for a perfect home office.",
    "dailyPrice": 450,
    "isActive": true,
    "verifiedByAdm": false,
    "specialOffer": false,
    "type": {
      "name": "A whole place"
    },
    "owner": {
      "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
      "username": "Bob Spencer",
      "email": "bobspencer@email.com",
      "dateOfBirth": "14/03/1993",
      "photo": "L2dvYWwgbW9yZJShu54j98vgSD79",
      "isAdm": false,
      "isActive": true
    },
    "capacity": {
      "rooms": 2,
      "beds": 2,
      "totalGuests": 4,
      "bathrooms": 2
    },
    "category": {
      "name": "Apartment"
    }
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 409 - Accommodation already registered**

```json
{
  "status": "Error",
  "code": 409,
  "message": "This accommodation is already registered"
}
```

<br>

**Status 404 - User not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "User not found"
}
```

<br>

**Status 404 - Type not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Type not found"
}
```

<br>

**Status 404 - Capacity not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Capacity not found"
}
```

<br>

**Status 404 - Category not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Category not found"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## GET /accommodations

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "accommodations": [
    {
      "id": "90ee8282-af60-4570-9847-fb99d5555355",
      "name": "Complete apartment to work",
      "description": "Ideal apartment to work remotely, quiet, comfortable, and with all the requirements for a perfect home office.",
      "dailyPrice": 450,
      "isActive": true,
      "verifiedByAdm": false,
      "specialOffer": false,
      "type": {
        "name": "A whole place"
      },
      "owner": {
        "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
        "username": "Bob Spencer",
        "email": "bobspencer@email.com",
        "dateOfBirth": "14/03/1993",
        "photo": "L2dvYWwgbW9yZJShu54j98vgSD79",
        "isAdm": false,
        "isActive": true
      },
      "capacity": {
        "rooms": 2,
        "beds": 2,
        "totalGuests": 4,
        "bathrooms": 2
      },
      "category": {
        "name": "Apartment"
      }
    },
    ...
  ]
}


```

<br>

#### Error Responses:

- No errors expected

#

## GET /accommodations/:accommodationId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "accommodation": {
    "id": "90ee8282-af60-4570-9847-fb99d5555355",
    "name": "Complete apartment to work",
    "description": "Ideal apartment to work remotely, quiet, comfortable, and with all the requirements for a perfect home office.",
    "dailyPrice": 450,
    "isActive": true,
    "verifiedByAdm": false,
    "specialOffer": false,
    "type": {
      "name": "A whole place"
    },
    "owner": {
      "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
      "username": "Bob Spencer",
      "email": "bobspencer@email.com",
      "dateOfBirth": "14/03/1993",
      "photo": "L2dvYWwgbW9yZJShu54j98vgSD79",
      "isAdm": false,
      "isActive": true
    },
    "capacity": {
      "rooms": 2,
      "beds": 2,
      "totalGuests": 4,
      "bathrooms": 2
    },
    "category": {
      "name": "Apartment"
    }
  }
}
```

<br>

#### Error Responses:

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

#

## PATCH /accommodations/:accommodationId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be the owner of the accommodation or an admin
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "name?": "Complete apartment to work",
  "description?": "Ideal apartment to work remotely, quiet, comfortable, and with all the requirements for a perfect home office.",
  "dailyPrice?": 300,
  "specialOffer?": true,
  "*verifiedByAdm?": true,
  "typeId?": "6e79c2b7-c479-46e3-aeac-b9f62739799e",
  "capacityId?": "0b327321-603d-45a7-b4cd-525c11c14b04"
}
```

- At least one field is required
- The field verifiedByAdm can only be updated by an Adm

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Accommodation updated with success",
  "accommodation": {
    "id": "90ee8282-af60-4570-9847-fb99d5555355",
    "name": "Complete apartment to work",
    "description": "Ideal apartment to work remotely, quiet, comfortable, and with all the requirements for a perfect home office.",
    "dailyPrice": 300,
    "isActive": true,
    "verifiedByAdm": false,
    "specialOffer": true,
    "type": {
      "name": "A whole place"
    },
    "owner": {
      "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
      "username": "Bob Spencer",
      "email": "bobspencer@email.com",
      "dateOfBirth": "14/03/1993",
      "photo": "L2dvYWwgbW9yZJShu54j98vgSD79",
      "isAdm": false,
      "isActive": true
    },
    "capacity": {
      "rooms": 2,
      "beds": 2,
      "totalGuests": 4,
      "bathrooms": 2
    },
    "category": {
      "name": "Apartment"
    }
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the accommodation**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the accommodation"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 400 - No changes in accommodation data**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Not possible to update an accommodation without having any changes in any field"
}
```

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

**Status 404 - Type not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Type not found"
}
```

<br>

**Status 404 - Capacity not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Capacity not found"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## DELETE /accommodations/:accommodationId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be the owner of the accommodation or an admin
- Content-type: application/json
- Empty body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Accommodation deleted with success"
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the accommodation**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the accommodation"
}
```

<br>

**Status 400 - Accommodation already deleted**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Accommodation already deleted"
}
```

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

---

## 4. **Bookings**

[ Back to endpoints index ](#index)

# Bookings

The Booking object is defined as:

| **Field**       | **Type** | **Description**                                  |
| --------------- | -------- | ------------------------------------------------ |
| id              | string   | Booking's unique identifier                      |
| checkIn         | string   | Defines the data and time for a chekin           |
| checkout        | string   | Defines the data and time for a checkout         |
| accommodationId | string   | Accommodation's unique identifier                |
| status          | string   | Defines if the booking is "booked" or "canceled" |
| userId          | string   | User's unique idetifier                          |

<br>

### **Endpoints**

| **Method** | **Route**            | **Description**                                    |
| ---------- | -------------------- | -------------------------------------------------- |
| POST       | /bookings            | Creates a new booking                              |
| GET        | /bookings            | List all bookings                                  |
| GET        | /bookings/:bookingId | Lists a booking using its ID as a parameter        |
| DELETE     | /bookings/:bookingId | Soft-deletes a booking using its ID as a parameter |

<br>

#

## POST /bookings

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "checkIn": "2023/01/12",
  "checkout": "2023/05/12",
  "accommodationId": "402c85e9-46d9-4471-8e33-46954319261a",
  "userId": "17851b8b-a8ea-48ad-98bb-0f2fc86a8459"
}
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "Booking created with success",
  "booking": {
    "id": "f4939be7-3790-4f67-97d0-f2c17739d807",
    "checkIn": "2023/01/12",
    "checkout": "2023/05/12",
    "accommodationId": "402c85e9-46d9-4471-8e33-46954319261a",
    "status": "booked",
    "userId": "17851b8b-a8ea-48ad-98bb-0f2fc86a8459"
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 400 - Unavailable booking dates**

```json
{
  "status": "Error",
  "code": 400,
  "message": "These dates are unavailable"
}
```

<br>

**Status 409 - Booking already registered**

```json
{
  "status": "Error",
  "code": 409,
  "message": "This booking is already registered"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## GET /bookings

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin
- Content-type: application/json
- Empty body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
    "message": "Successful request",
    "bookings": [
      {
          "id": "f4939be7-3790-4f67-97d0-f2c17739d807",
          "checkIn": "2023/01/12",
          "checkout": "2023/05/12",
          "accommodationId": "402c85e9-46d9-4471-8e33-46954319261a",
          "status": "booked",
          "userId": "17851b8b-a8ea-48ad-98bb-0f2fc86a8459"
      },
    ...
    ]
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## GET /bookings/:bookingId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be the owner of the accommodation, the guest that booked the booking, or an admin
- Content-type: application/json
- Empty body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "booking": {
    "id": "f4939be7-3790-4f67-97d0-f2c17739d807",
    "checkIn": "2023/01/12",
    "checkout": "2023/05/12",
    "accommodationId": "402c85e9-46d9-4471-8e33-46954319261a",
    "status": "booked",
    "userId": "17851b8b-a8ea-48ad-98bb-0f2fc86a8459"
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not the owner of the accommodation, the guest that booked the booking, or an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be the owner of the accommodation, the guest that booked the booking, or an admin"
}
```

<br>

**Status 404 - Booking not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Booking not found"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## DELETE /bookings/:bookingId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be the owner of the accommodation, the guest that booked the booking, or an admin
- Content-type: application/json
- Empty body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Booking deleted with success"
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not the owner of the accommodation, the guest that booked the booking, or an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be the owner of the accommodation, the guest that booked the booking, or an admin"
}
```

<br>

**Status 400 - Booking already deleted**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Booking already deleted"
}
```

<br>

**Status 404 - Booking not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Booking not found"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

---

## 5. **Addresses**

[ Back to endpoints index ](#index)

# Addresses

The Address object is defined as:

| **Field**       | **Type** | **Description**                                   |
| --------------- | -------- | ------------------------------------------------- |
| country         | string   | Defines the country of the address                |
| state           | string   | Defines the state of the address                  |
| city            | string   | Defines the city of the address                   |
| postalCode      | string   | Defines the postal Code of the address            |
| street          | string   | Defines the street of the address                 |
| complement      | string   | Defines the complement of the address             |
| accommodationId | string   | Accommodation's unique identifier of this address |

<br>

### **Endpoints**

| **Method** | **Route**             | **Description**                                |
| ---------- | --------------------- | ---------------------------------------------- |
| POST       | /addresses            | Creates a new address                          |
| PATCH      | /addresses/:addressId | Updates an address using its ID as a parameter |

<br>

#

## POST /addresses

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be the owner of the accommodation of the new address or an admin
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "country": "Brazil",
  "state": "Espirito Santo",
  "city": "Serra",
  "postalCode": "29163663",
  "street": "Rosemberg",
  "complement": "Quadra 45, Setor Ásia",
  "accommodationId": "661dc120-4851-47ec-8a76-216e8380345e"
}
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "Address created with success",
  "address": {
    "id": "4a944707-6c5e-4ea9-a2c8-882196d3904f",
    "country": "Brazil",
    "state": "Espirito Santo",
    "city": "Serra",
    "postalCode": "29163663",
    "street": "Rosemberg",
    "complement": "Quadra 45, Setor Ásia",
    "accommodationId": "661dc120-4851-47ec-8a76-216e8380345e"
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not the owner of the accommodation set at this address or an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be the owner of the accommodation set at this address or an admin"
}
```

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

**Status 409 - Address already registered in this accommodation**

```json
{
  "status": "Error",
  "code": 409,
  "message": "Address already registered in this accommodation"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## PATCH /addresses/:addressId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be the owner of the accommodation set at this address or an admin
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "postalCode?": "29163663",
  "street?": "Rosemberg",
  "complement?": "Quadra 45, Setor Ásia",
  "accommodationId": "661dc120-4851-47ec-8a76-216e8380345e"
}
```

- accommodationId is a required field
- At least one of these fields is required:
  - postalCode
  - street
  - complement

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Address updated with success",
  "address": {
    "id": "4a944707-6c5e-4ea9-a2c8-882196d3904f",
    "country": "Brazil",
    "state": "Espirito Santo",
    "city": "Serra",
    "postalCode": "29163663",
    "street": "Rosemberg",
    "complement": "Quadra 45, Setor Ásia",
    "accommodationId": "661dc120-4851-47ec-8a76-216e8380345e"
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not the owner of the accommodation set at this address or an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be the owner of the accommodation set at this address or an admin"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 400 - No changes in address data**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Not possible to update an address without having any changes in any field"
}
```

<br>

**Status 404 - Address not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Address not found"
}
```

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

---

## 6. **Categories**

[ Back to endpoints index ](#index)

# Categories

The Category object is defined as:

| **Field** | **Type** | **Description**                             |
| --------- | -------- | ------------------------------------------- |
| id        | string   | Category's unique identifier                |
| name      | string   | Category name                               |
| isActive  | boolean  | Defines whether a category is active or not |

<br>

### **Endpoints**

| **Method** | **Route**               | **Description**                                     |
| ---------- | ----------------------- | --------------------------------------------------- |
| POST       | /categories             | Creates a category                                  |
| GET        | /categories             | List all categories                                 |
| GET        | /categories/:categoryId | Lists a category using its ID as a parameter        |
| PATCH      | /categories/:categoryId | Updates a category using its ID as a parameter      |
| DELETE     | /categories/:categoryId | Soft-deletes a category using its ID as a parameter |

<br>

#

## POST /categories

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to create a category
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "name": "Apartment"
}
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "Category created with success",
  "category": {
    "id": "fc540668-a80c-4690-8889-1c89c5a51b5c",
    "name": "Apartment",
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 409 - This category already exists**

```json
{
  "status": "Error",
  "code": 409,
  "message": "This category already exists"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## GET /categories

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "categories":
  [
    {
      "id": "fc540668-a80c-4690-8889-1c89c5a51b5c",
      "name": "Apartment",
      "isActive": true
    },
  ...
  ]
}
```

<br>

#### Error Responses:

- No errors expected

#

## GET /categories/:categoryId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "category": {
    "id": "fc540668-a80c-4690-8889-1c89c5a51b5c",
    "name": "Apartment",
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status - 404 - Category not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Category not found"
}
```

<br>

#

## PATCH /categories/:categoryId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to update a category
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "name": "Studio"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Category updated with success",
  "category": {
    "id": "fc540668-a80c-4690-8889-1c89c5a51b5c",
    "name": "Studio",
    "isActive": true
  }
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 404 - Category not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Category not found"
}
```

<br>

**Status 400 - No changes in category data**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Not possible to update a category without having any changes in any field"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## DELETE /categories/:categoryId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to delete a category
- Content-type: application/json
- Empty body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Category deleted with success"
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 404 - Category not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Category not found"
}
```

<br>

**Status 400 - Category already deleted**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Category already deleted"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

---

## 7. **Capacities**

[ Back to endpoints index ](#index)

# Capacities

The Capacity object is defined as:

| **Field**   | **Type** | **Description**                                |
| ----------- | -------- | ---------------------------------------------- |
| id          | string   | Capacity's unique identifier                   |
| rooms       | number   | Number of capacity rooms                       |
| beds        | number   | Number of capacity beds                        |
| totalGuests | number   | Total number of guests that the capacity hosts |
| bathrooms   | number   | Number of capacity bathrooms                   |
| isActive    | boolean  | Defines whether a capacity is active or not    |

<br>

### **Endpoints**

| **Method** | **Route**               | **Description**                                     |
| ---------- | ----------------------- | --------------------------------------------------- |
| POST       | /capacities             | Creates a capacity                                  |
| GET        | /capacities             | List all capacities                                 |
| GET        | /capacities/:capacityId | Lists a capacity using its ID as a parameter        |
| PATCH      | /capacities/:capacityId | Updates a capacity using its ID as a parameter      |
| DELETE     | /capacities/:capacityId | Soft-deletes a capacity using its ID as a parameter |

<br>

## POST /capacities

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to create a capacity
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "rooms": 2,
  "beds": 2,
  "totalGuests": 4,
  "bathrooms": 2
}
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "Capacity created with success",
  "capacity": {
    "id": "3aa9018f-1415-4caf-a382-07aff5e0076a",
    "rooms": 2,
    "beds": 2,
    "totalGuests": 4,
    "bathrooms": 2,
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 409 - This capacity already exists**

```json
{
  "status": "Error",
  "code": 409,
  "message": "This capacity already exists"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## GET /capacities

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "capacities":
  [
    {
      "id": "3aa9018f-1415-4caf-a382-07aff5e0076a",
      "rooms": 2,
      "beds": 2,
      "totalGuests": 4,
      "bathrooms": 2,
      "isActive": true
    },
  ...
  ]
}
```

<br>

#### Error Responses:

- No errors expected

#

## GET /capacities/:capacityId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "capacity": {
    "id": "3aa9018f-1415-4caf-a382-07aff5e0076a",
    "rooms": 2,
    "beds": 2,
    "totalGuests": 4,
    "bathrooms": 2,
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status 404 - Capacity not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Capacity not found"
}
```

<br>

#

## PATCH /capacities/:capacityId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to update a capacity
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "rooms?": 1,
  "beds?": 1,
  "totalGuests?": 2,
  "bathrooms?": 1
}
```

- At least one field is required

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Capacity updated with success",
  "capacity": {
    "id": "3aa9018f-1415-4caf-a382-07aff5e0076a",
    "rooms": 1,
    "beds": 1,
    "totalGuests": 2,
    "bathrooms": 1,
    "isActive": true
  }
}
```

<br>

#### Expected Errors:

<br>

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 404 - Capacity not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Capacity not found"
}
```

<br>

**Status 400 - No changes in capacity data**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Not possible to update a capacity without having any changes in any field"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## DELETE /capacities/:capacityId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to delete a capacity
- Content-type: application/json
- Empty body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Capacity deleted with success"
}
```

<br>

#### Expected Errors:

<br>

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 404 - Capacity not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Capacity not found"
}
```

<br>

**Status 400 - Capacity already deleted**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Capacity already deleted"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

---

## 8. **Types**

[ Back to endpoints index ](#index)

# Types

The Type object is defined as:

| **Field** | **Type** | **Description**                         |
| --------- | -------- | --------------------------------------- |
| id        | string   | Type's unique identifier                |
| name      | string   | Type name                               |
| isActive  | boolean  | Defines whether a type is active or not |

<br>

### **Endpoints**

| **Method** | **Route**      | **Description**                                 |
| ---------- | -------------- | ----------------------------------------------- |
| POST       | /types         | Creates a type                                  |
| GET        | /types         | List all types                                  |
| GET        | /types/:typeId | Lists a type using its ID as a parameter        |
| PATCH      | /types/:typeId | Updates a type using its ID as a parameter      |
| DELETE     | /types/:typeId | Soft-deletes a type using its ID as a parameter |

<br>

## POST /types

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to create a type
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "name": "A whole place"
}
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "Type created with success",
  "type": {
    "id": "d57d66cf-3feb-4849-9a86-b8b5654a74af",
    "name": "A whole place",
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 409 - This type already exists**

```json
{
  "status": "Error",
  "code": 409,
  "message": "This type already exists"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## GET /types

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "types":
  [
    {
      "id": "d57d66cf-3feb-4849-9a86-b8b5654a74af",
      "name": "A whole place",
      "isActive": true
    },
  ...
  ]
}
```

<br>

#### Error Responses:

- No errors expected

#

## GET /types/:typeId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "type": {
    "id": "d57d66cf-3feb-4849-9a86-b8b5654a74af",
    "name": "A whole place",
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status 404 - Type not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Type not found"
}
```

<br>

#

## PATCH /types/:typeId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to update a type
- Content-type: application/json

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```json
{
  "name": "A shared place"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Type updated with success",
  "type": {
    "id": "d57d66cf-3feb-4849-9a86-b8b5654a74af",
    "name": "A shared place",
    "isActive": true
  }
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 400 - Invalid data type or length**

```json
{
  "status": "Error",
  "code": 400,
  "message": "yup error message"
}
```

<br>

**Status 404 - Type not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Type not found"
}
```

<br>

**Status 400 - No changes in type data**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Not possible to update a type without having any changes in any field"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## DELETE /types/:typeId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Admin Bearer Token
- User must be an admin to delete a type
- Content-type: application/json
- Empty body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Type deleted with success"
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

**Status 404 - Type not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Type not found"
}
```

<br>

**Status 400 - Type already deleted**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Type already deleted"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

---

## 9. **Photos**

[ Back to endpoints index ](#index)

# Photos

The Photo object is defined as:

| **Field**       | **Type** | **Description**                   |
| --------------- | -------- | --------------------------------- |
| id              | string   | Photo's unique identifier         |
| file            | file     | Photo file sent in the request    |
| accommodationId | string   | Accommodation's unique identifier |
| content         | string   | Photo url generated by cloudinary |

<br>

### **Endpoints**

| **Method** | **Route**                | **Description**                                                                                |
| ---------- | ------------------------ | ---------------------------------------------------------------------------------------------- |
| POST       | /photos/:accommodationId | Creates a new photo of an accommodation using the accommodation ID as a parameter              |
| GET        | /photos/:accommodationId | Lists all photos of an accommodation using the accommodation ID as a parameter                 |
| GET        | /photos/:photoId         | Lists a photo of an accommodation using the accommodation ID and photo ID as parameters        |
| DELETE     | /photos/:photoId         | Soft-deletes a photo of an accommodation using the accommodation ID and photo ID as parameters |

<br>

## POST /photos/:accommodationId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be the owner of this photo's accommodation or an admin
- Content-type: multipart/form-data

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

**Request body example**

```multipart/form-data
  file: file.jpg
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "Photo created with success",
  "photo": {
    "id": "cfa647b0-5100-4633-ada4-ad17b7f58626",
    "content": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
    "accommodationId": "3ef51e41-efe6-4f0e-908f-190301ff645a"
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the accommodation**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the accommodation"
}
```

<br>

**Status 400 - Missing photo file**

```json
{
  "status": "Error",
  "code": 400,
  "message": "file is a required field"
}
```

<br>

**Status 400 - Invalid file type**

```json
{
  "status": "Error",
  "code": 400,
  "message": "file has an invalid type"
}
```

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

**Status 409 - Photo already registered in this accommodation**

```json
{
  "status": "Error",
  "code": 409,
  "message": "Photo already registered in this accommodation"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

#

## GET /photos/:accommodationId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty Body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "photos": [
    {
      "id": "cfa647b0-5100-4633-ada4-ad17b7f58626",
      "content": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
      "accommodationId": "3ef51e41-efe6-4f0e-908f-190301ff645a"
    },
    ...
  ]
}
```

<br>

#### Error Responses:

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

#

## GET /photos/:photoId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: application/json
- Empty Body

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "photo": {
    "id": "cfa647b0-5100-4633-ada4-ad17b7f58626",
    "content": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
    "accommodationId": "3ef51e41-efe6-4f0e-908f-190301ff645a"
  }
}
```

<br>

#### Error Responses:

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

**Status 404 - Photo not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Photo not found"
}
```

<br>

#

## DELETE /photos/:photoId

[ Back to endpoints index ](#index)

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be the owner of this photo's accommodation or an admin
- Content-type: application/json
- Empty Body

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Photo deleted with success"
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the accommodation**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the accommodation"
}
```

<br>

**Status 404 - Accommodation not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Accommodation not found"
}
```

<br>

**Status 404 - Photo not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "Photo not found"
}
```

<br>

**Status 400 - Photo already deleted**

```json
{
  "status": "Error",
  "code": 400,
  "message": "Photo already deleted"
}
```

<br>

**Status 400 - Account is deactivated**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Account deactivated, please contact our customer services for more information"
}
```

<br>

---
